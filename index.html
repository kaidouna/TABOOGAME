<!-- Offline Role Selection Overlay -->
<div id="offlineRoleOverlay">
  <h2>Select Your Role</h2>
  <button onclick="setOfflineRole('describer')">Describer</button>
  <button onclick="setOfflineRole('guesser')">Guesser</button>
</div>

<style>
#offlineRoleOverlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  z-index: 99999;
}
#offlineRoleOverlay button {
  padding: 0.6rem 1.2rem;
  font-size: 1.2rem;
  cursor: pointer;
}
</style>

<script>
function setOfflineRole(role) {
  localStorage.setItem('offlinePlayerRole', role);
  document.getElementById('offlineRoleOverlay').style.display = 'none';
  applyOfflineRoleView(role);
}

function applyOfflineRoleView(role) {
  const describerView = document.getElementById('describer-view');
  const guesserView = document.getElementById('guesser-view');
  const wordsGrid = document.getElementById('words-grid');
  const guessInput = document.getElementById('guess-input');

  if (role === 'describer') {
    if (describerView) describerView.style.display = 'block';
    if (guesserView) guesserView.style.display = 'none';
    if (wordsGrid) wordsGrid.style.display = 'none'; // stays hidden until game starts
  } else {
    if (describerView) describerView.style.display = 'none';
    if (guesserView) guesserView.style.display = 'block';
    if (guessInput) guessInput.value = '';
  }
}

// Autoâ€‘apply saved role on load
window.addEventListener('DOMContentLoaded', () => {
  const savedRole = localStorage.getItem('offlinePlayerRole');
  if (savedRole) {
    document.getElementById('offlineRoleOverlay').style.display = 'none';
    applyOfflineRoleView(savedRole);
  }
});
</script>





<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TABOGAME - Multiplayer Word Game</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            width: 100%;
            max-width: 1000px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
        }
        
        header {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        
        .settings-icon {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .settings-icon:hover {
            transform: rotate(45deg);
            background: rgba(255, 255, 255, 0.3);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .setup-screen {
            padding: 30px;
            text-align: center;
        }
        
        .setup-screen h2 {
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .input-group {
            margin: 20px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .input-group input {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.2rem;
            width: 300px;
            outline: none;
            text-align: center;
        }
        
        .team-selection, .role-selection {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .team-card, .role-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            width: 220px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .team-card:hover, .role-card:hover {
            transform: translateY(-5px);
        }
        
        .team-card.selected, .role-card.selected {
            border: 3px solid #2ecc71;
            transform: scale(1.05);
        }
        
        .red-team i {
            color: #e74c3c;
        }
        
        .blue-team i {
            color: #3498db;
        }
        
        .describer-card i {
            color: #f39c12;
        }
        
        .guesser-card i {
            color: #2ecc71;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
        }
        
        .btn-primary {
            background: #2ecc71;
            color: white;
        }
        
        .btn-secondary {
            background: #3498db;
            color: white;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .game-screen {
            display: none;
            padding: 20px;
        }
        
        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            color: white;
            font-weight: bold;
        }
        
        .red-team-header {
            background: #e74c3c;
        }
        
        .blue-team-header {
            background: #3498db;
        }
        
        .timer {
            font-size: 3rem;
            font-weight: bold;
            color: #e74c3c;
            margin: 20px 0;
            background: #fdedec;
            padding: 15px 30px;
            border-radius: 15px;
            text-align: center;
        }
        
        .describer-view, .guesser-view {
            display: none;
        }
        
        .words-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 30px 0;
        }
        
        .word-card {
            background: #3498db;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .word-card.correct {
            background: #2ecc71;
        }
        
        .input-section {
            margin: 20px 0;
            text-align: center;
        }
        
        input {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.2rem;
            width: 300px;
            outline: none;
        }
        
        .score-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0;
            text-align: center;
        }
        
        .instructions {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .role-switch-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }
        
        /* Settings Modal */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .settings-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
        }
        
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }
        
        .settings-header h2 {
            color: #2c3e50;
        }
        
        .close-settings {
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .close-settings:hover {
            color: #34495e;
        }
        
        .setting-item {
            margin-bottom: 20px;
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .setting-item input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .setting-item .value-display {
            margin-top: 5px;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .save-settings {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        
        .save-settings:hover {
            background: #27ae60;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #2ecc71;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
        }
        
        @media (max-width: 768px) {
            .words-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .team-selection, .role-selection {
                flex-direction: column;
                align-items: center;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="settings-icon" onclick="openSettings()">
                <i class="fas fa-cog"></i>
            </div>
            <h1>TABOGAME</h1>
            <p>Multiplayer Word Game</p>
        </header>
        
        <!-- Settings Modal -->
        <div class="settings-modal" id="settings-modal">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>Game Settings</h2>
                    <div class="close-settings" onclick="closeSettings()">
                        <i class="fas fa-times"></i>
                    </div>
                </div>
                
                <div class="setting-item">
                    <label for="rounds">Number of Rounds</label>
                    <input type="range" id="rounds" min="1" max="10" value="3" step="1">
                    <div class="value-display" id="rounds-value">3 rounds</div>
                </div>
                
                <div class="setting-item">
                    <label for="timer">Timer Duration (seconds)</label>
                    <input type="range" id="timer" min="30" max="180" value="90" step="10">
                    <div class="value-display" id="timer-value">90 seconds</div>
                </div>
                
                <div class="setting-item">
                    <label for="words">Number of Words</label>
                    <input type="range" id="words" min="5" max="30" value="20" step="5">
                    <div class="value-display" id="words-value">20 words</div>
                </div>
                
                <button class="save-settings" onclick="saveSettings()">Save Settings</button>
            </div>
        </div>
        
        <!-- Notification -->
        <div class="notification" id="notification">
            Settings saved successfully!
        </div>
        
        <!-- Player Name Screen -->
        <div class="setup-screen" id="name-screen">
            <h2>Enter Your NickName</h2>
            <div class="input-group">
                <input type="text" id="player-name" placeholder="Your name" maxlength="15">
            </div>
            <button class="btn btn-primary" onclick="submitName()">Continue</button>
        </div>
        
        <!-- Team Selection Screen -->
        <div class="setup-screen" id="team-screen" style="display: none;">
            <h2>Select Your Team</h2>
            <div class="team-selection">
                <div class="team-card red-team" onclick="selectTeam('red')">
                    <i class="fas fa-fire fa-3x"></i>
                    <h3>Red Team</h3>
                </div>
                
                <div class="team-card blue-team" onclick="selectTeam('blue')">
                    <i class="fas fa-tint fa-3x"></i>
                    <h3>Blue Team</h3>
                </div>
            </div>
            <button class="btn btn-primary" onclick="submitTeam()">Continue</button>
            <button class="btn btn-secondary" onclick="switchScreen('name-screen')">Back</button>
        </div>
        
        <!-- Role Selection Screen -->
        <div class="setup-screen" id="role-screen" style="display: none;">
            <h2>Select Your Role</h2>
            <div class="role-selection">
                <div class="role-card describer-card" onclick="selectRole('describer')">
                    <i class="fas fa-microphone-alt fa-3x"></i>
                    <h3>Describer</h3>
                    <p>See words and describe them</p>
                </div>
                
                <div class="role-card guesser-card" onclick="selectRole('guesser')">
                    <i class="fas fa-ear-listen fa-3x"></i>
                    <h3>Guesser</h3>
                    <p>Listen and guess words</p>
                </div>
            </div>
            <button class="btn btn-primary" onclick="submitRole()">Continue</button>
            <button class="btn btn-secondary" onclick="switchScreen('team-screen')">Back</button>
            <button class="btn btn-danger" onclick="leaveTeam()">Leave Team</button>
        </div>
        
        <!-- Word List Upload Screen -->
        <div class="setup-screen" id="wordlist-screen" style="display: none;">
            <h2>Upload Word List</h2>
            <div class="input-group">
                <input type="file" id="word-file" accept=".txt">
                <div id="file-status">No file selected</div>
            </div>
            <button class="btn btn-primary" onclick="loadWordList()">Load Words</button>
            <button class="btn btn-secondary" onclick="useDefaultWords()">Use Default Words</button>
            <button class="btn btn-secondary" onclick="switchScreen('role-screen')">Back</button>
            <button class="btn btn-danger" onclick="leaveTeam()">Leave Team</button>
        </div>
        
        <!-- Game Screen -->
        <div class="game-screen" id="game-screen">
            <div class="team-header" id="team-header">
                <span id="team-name">Team</span>
                <span id="player-info">Player Name - Role</span>
                <button class="btn btn-danger" onclick="leaveGame()">Leave Game</button>
            </div>
            
            <div class="timer" id="timer">90s</div>
            
            <div class="describer-view" id="describer-view">
                <h2>Describe words to your team</h2>
                <p>Click "Start Game" to begin. Words will appear after you start.</p>
                
                <div class="words-grid" id="words-grid" style="display: none;">
                    <!-- Words will be dynamically inserted here -->
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="start-button" onclick="startGame()">Start Game</button>
                    <button class="btn btn-secondary" onclick="switchRole()">Switch Role</button>
                </div>
            </div>
            
            <div class="guesser-view" id="guesser-view">
                <h2>Listen to your team's descriptions</h2>
                <p>Type the word you think is being described</p>
                
                <div class="input-section">
                    <input type="text" id="guess-input" placeholder="Type your guess here...">
                    <button class="btn btn-primary" onclick="submitGuess()">Submit</button>
                </div>
                
                <div class="score-display">
                    Score: <span id="score">0</span> points
                </div>
                
                <div class="role-switch-notice" id="role-switch-notice" style="display: none;">
                    <i class="fas fa-info-circle"></i> You switched roles. The game continues.
                </div>
                
                <div class="words-grid" id="guessed-words">
                    <!-- Correctly guessed words will appear here -->
                </div>
                
                <button class="btn btn-secondary" onclick="switchRole()">Switch Role</button>
            </div>
            
            <div class="instructions">
                <h3>Game Instructions</h3>
                <ul>
                    <li><strong>Describers:</strong> Describe words without saying the word itself</li>
                    <li><strong>Guessers:</strong> Type the word you think is being described</li>
                    <li>You have <span id="settings-timer">90</span> seconds to guess as many words as possible</li>
                    <li>Each correct guess is worth 10 points</li>
                    <li>Game consists of <span id="settings-rounds">3</span> rounds with <span id="settings-words">20</span> words each</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let gameActive = false;
        let timeLeft = 90;
        let timerInterval;
        let currentWords = [];
        let guessedWords = [];
        let score = 0;
        let playerName = '';
        let playerTeam = '';
        let playerRole = '';
        
        // Game settings with default values
        let gameSettings = {
            rounds: 3,
            timerDuration: 90,
            wordCount: 20
        };
        
        // Default word list
        const defaultWords = [
            "apple", "banana", "orange", "grape", "melon",
            "computer", "keyboard", "mouse", "monitor", "laptop",
            "river", "mountain", "forest", "ocean", "desert",
            "book", "pencil", "paper", "teacher", "student",
            "sun", "moon", "star", "planet", "galaxy",
            "pizza", "burger", "pasta", "salad", "soup",
            "car", "bicycle", "train", "airplane", "ship",
            "dog", "cat", "bird", "fish", "rabbit"
        ];
        
        // DOM elements
        const nameScreen = document.getElementById('name-screen');
        const teamScreen = document.getElementById('team-screen');
        const roleScreen = document.getElementById('role-screen');
        const wordlistScreen = document.getElementById('wordlist-screen');
        const gameScreen = document.getElementById('game-screen');
        const describerView = document.getElementById('describer-view');
        const guesserView = document.getElementById('guesser-view');
        const timerEl = document.getElementById('timer');
        const wordsGridEl = document.getElementById('words-grid');
        const guessedWordsEl = document.getElementById('guessed-words');
        const scoreEl = document.getElementById('score');
        const guessInput = document.getElementById('guess-input');
        const teamHeader = document.getElementById('team-header');
        const teamNameEl = document.getElementById('team-name');
        const playerInfoEl = document.getElementById('player-info');
        const startButton = document.getElementById('start-button');
        const fileStatus = document.getElementById('file-status');
        const roleSwitchNotice = document.getElementById('role-switch-notice');
        const settingsModal = document.getElementById('settings-modal');
        const notification = document.getElementById('notification');
        
        // Initialize settings sliders
        function initSettings() {
            const roundsSlider = document.getElementById('rounds');
            const timerSlider = document.getElementById('timer');
            const wordsSlider = document.getElementById('words');
            const roundsValue = document.getElementById('rounds-value');
            const timerValue = document.getElementById('timer-value');
            const wordsValue = document.getElementById('words-value');
            
            // Set initial values
            roundsSlider.value = gameSettings.rounds;
            timerSlider.value = gameSettings.timerDuration;
            wordsSlider.value = gameSettings.wordCount;
            
            // Update displays
            roundsValue.textContent = `${gameSettings.rounds} rounds`;
            timerValue.textContent = `${gameSettings.timerDuration} seconds`;
            wordsValue.textContent = `${gameSettings.wordCount} words`;
            
            // Add event listeners
            roundsSlider.addEventListener('input', function() {
                roundsValue.textContent = `${this.value} rounds`;
            });
            
            timerSlider.addEventListener('input', function() {
                timerValue.textContent = `${this.value} seconds`;
            });
            
            wordsSlider.addEventListener('input', function() {
                wordsValue.textContent = `${this.value} words`;
            });
            
            // Update instructions
            updateInstructions();
        }
        
        // Update instructions with current settings
        function updateInstructions() {
            document.getElementById('settings-timer').textContent = gameSettings.timerDuration;
            document.getElementById('settings-rounds').textContent = gameSettings.rounds;
            document.getElementById('settings-words').textContent = gameSettings.wordCount;
        }
        
        // Open settings modal
        function openSettings() {
            settingsModal.style.display = 'flex';
        }
        
        // Close settings modal
        function closeSettings() {
            settingsModal.style.display = 'none';
        }
        
        // Save settings
        function saveSettings() {
            const roundsSlider = document.getElementById('rounds');
            const timerSlider = document.getElementById('timer');
            const wordsSlider = document.getElementById('words');
            
            gameSettings.rounds = parseInt(roundsSlider.value);
            gameSettings.timerDuration = parseInt(timerSlider.value);
            gameSettings.wordCount = parseInt(wordsSlider.value);
            
            // Update timer display if game is not active
            if (!gameActive) {
                timeLeft = gameSettings.timerDuration;
                timerEl.textContent = `${timeLeft}s`;
            }
            
            // Update instructions
            updateInstructions();
            
            // Show notification
            showNotification('Settings saved successfully!');
            
            // Close modal
            closeSettings();
        }
        
        // Show notification
        function showNotification(message) {
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Switch between setup screens
        function switchScreen(screenId) {
            nameScreen.style.display = 'none';
            teamScreen.style.display = 'none';
            roleScreen.style.display = 'none';
            wordlistScreen.style.display = 'none';
            gameScreen.style.display = 'none';
            
            document.getElementById(screenId).style.display = 'block';
        }
        
        // Submit player name
        function submitName() {
            playerName = document.getElementById('player-name').value.trim();
            if (!playerName) {
                alert('Please enter your name');
                return;
            }
            switchScreen('team-screen');
        }
        
        // Select team
        function selectTeam(team) {
            playerTeam = team;
            document.querySelectorAll('.team-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`.${team}-team`).classList.add('selected');
        }
        
        // Submit team selection
        function submitTeam() {
            if (!playerTeam) {
                alert('Please select a team');
                return;
            }
            switchScreen('role-screen');
        }
        
        // Select role
        function selectRole(role) {
            playerRole = role;
            document.querySelectorAll('.role-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`.${role}-card`).classList.add('selected');
        }
        
        // Submit role selection
        function submitRole() {
            if (!playerRole) {
                alert('Please select a role');
                return;
            }
            switchScreen('wordlist-screen');
        }
        
        // Leave team and go back to team selection
        function leaveTeam() {
            playerTeam = '';
            switchScreen('team-screen');
        }
        
        // Load word list from file
        function loadWordList() {
            const fileInput = document.getElementById('word-file');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Please select a file');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const contents = e.target.result;
                currentWords = contents.split('\n')
                    .map(word => word.trim())
                    .filter(word => word.length > 0);
                
                if (currentWords.length < gameSettings.wordCount) {
                    alert(`Your word list has only ${currentWords.length} words. We need at least ${gameSettings.wordCount} words. Using default words instead.`);
                    useDefaultWords();
                    return;
                }
                
                fileStatus.textContent = `Loaded ${currentWords.length} words`;
                initializeGame();
            };
            reader.readAsText(file);
        }
        
        // Use default words
        function useDefaultWords() {
            currentWords = [...defaultWords];
            fileStatus.textContent = `Using default word list (${currentWords.length} words)`;
            initializeGame();
        }
        
        // Initialize the game
        function initializeGame() {
            // Update UI with player info
            teamNameEl.textContent = `${playerTeam.charAt(0).toUpperCase() + playerTeam.slice(1)} Team`;
            playerInfoEl.textContent = `${playerName} - ${playerRole.charAt(0).toUpperCase() + playerRole.slice(1)}`;
            teamHeader.className = `team-header ${playerTeam}-team-header`;
            
            // Show the appropriate view based on role
            if (playerRole === 'describer') {
                describerView.style.display = 'block';
                guesserView.style.display = 'none';
                wordsGridEl.style.display = 'none';
            } else {
                describerView.style.display = 'none';
                guesserView.style.display = 'block';
            }
            
            // Reset game state
            score = 0;
            guessedWords = [];
            scoreEl.textContent = score;
            guessedWordsEl.innerHTML = '';
            timeLeft = gameSettings.timerDuration;
            timerEl.textContent = `${timeLeft}s`;
            
            switchScreen('game-screen');
        }
        
        // Start the game
        function startGame() {
            if (gameActive) return;
            
            gameActive = true;
            startButton.disabled = true;
            startButton.textContent = 'Game in Progress';
            
            // Show words to describer
            if (playerRole === 'describer') {
                wordsGridEl.style.display = 'grid';
                populateWordsGrid();
            }
            
            // Start the timer
            startTimer();
        }
        
        // Populate words grid for describer
        function populateWordsGrid() {
            wordsGridEl.innerHTML = '';
            
            // Select random words based on settings
            const gameWords = [...currentWords]
                .sort(() => 0.5 - Math.random())
                .slice(0, gameSettings.wordCount);
            
            gameWords.forEach(word => {
                const wordEl = document.createElement('div');
                wordEl.className = 'word-card';
                wordEl.textContent = word;
                wordEl.dataset.word = word;
                wordsGridEl.appendChild(wordEl);
            });
        }
        
        // Start the timer
        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = gameSettings.timerDuration;
            timerEl.textContent = `${timeLeft}s`;
            
            timerInterval = setInterval(() => {
                timeLeft--;
                timerEl.textContent = `${timeLeft}s`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    endGame();
                }
            }, 1000);
        }
        
        // Submit guess function
        function submitGuess() {
            if (!gameActive) {
                alert('The game has not started yet. Wait for the describer to start the game.');
                return;
            }
            
            const guess = guessInput.value.trim().toLowerCase();
            
            if (!guess) {
                alert('Please enter a word');
                return;
            }
            
            // Check if the word is in the current words list and not already guessed
            const wordElements = document.querySelectorAll('.word-card');
            let wordFound = false;
            
            wordElements.forEach(wordEl => {
                const word = wordEl.dataset.word.toLowerCase();
                if (word === guess && !guessedWords.includes(word)) {
                    // Correct guess
                    guessedWords.push(word);
                    score += 10;
                    scoreEl.textContent = score;
                    
                    // Add to guessed words display
                    const guessedWordEl = document.createElement('div');
                    guessedWordEl.className = 'word-card correct';
                    guessedWordEl.textContent = word;
                    guessedWordsEl.appendChild(guessedWordEl);
                    
                    // Mark as guessed in describer's view
                    wordEl.classList.add('correct');
                    
                    wordFound = true;
                }
            });
            
            if (wordFound) {
                // Clear input
                guessInput.value = '';
                
                // Check if all words have been guessed
                if (guessedWords.length >= gameSettings.wordCount) {
                    endGame();
                }
            } else if (guessedWords.includes(guess)) {
                alert('This word has already been guessed!');
            } else {
                alert('Not a valid word in the current list. Try again!');
            }
            
            guessInput.focus();
        }
        
        // Allow Enter key to submit guess
        guessInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                submitGuess();
            }
        });
        
        // Switch role function
        function switchRole() {
            // Simply toggle the role without interrupting the game
            if (playerRole === 'describer') {
                playerRole = 'guesser';
                // Update UI
                describerView.style.display = 'none';
                guesserView.style.display = 'block';
                
                // Show notice about role switch
                roleSwitchNotice.style.display = 'block';
                setTimeout(() => {
                    roleSwitchNotice.style.display = 'none';
                }, 3000);
            } else {
                playerRole = 'describer';
                guesserView.style.display = 'none';
                describerView.style.display = 'block';
                
                // If game is active, show the words
                if (gameActive) {
                    wordsGridEl.style.display = 'grid';
                }
                
                // Show notice about role switch
                roleSwitchNotice.style.display = 'block';
                setTimeout(() => {
                    roleSwitchNotice.style.display = 'none';
                }, 3000);
            }
            
            // Update the player info
            playerInfoEl.textContent = `${playerName} - ${playerRole.charAt(0).toUpperCase() + playerRole.slice(1)}`;
        }
        
        // Leave game function
        function leaveGame() {
            if (confirm('Are you sure you want to leave the game?')) {
                clearInterval(timerInterval);
                gameActive = false;
                switchScreen('name-screen');
            }
        }
        
        // End the game
        function endGame() {
            gameActive = false;
            clearInterval(timerInterval);
            
            alert(`Game over! Your score: ${score} points. You guessed ${guessedWords.length} out of ${gameSettings.wordCount} words.`);
            
            // Enable start button for new game
            startButton.disabled = false;
            startButton.textContent = 'Start New Game';
        }
        
        // Initialize the settings when page loads
        window.addEventListener('load', function() {
            initSettings();
        });
    </script>
</body>

</html>
