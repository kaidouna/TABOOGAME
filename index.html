<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaboGame - Word Game</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            width: 100%;
            max-width: 1000px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
            backdrop-filter: blur(10px);
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .settings-icon {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .settings-icon:hover {
            transform: rotate(45deg);
            background: rgba(255, 255, 255, 0.3);
        }
        
        .setup-screen {
            padding: 40px;
            text-align: center;
        }
        
        .setup-screen h2 {
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2rem;
            font-weight: 600;
        }
        
        .input-group {
            margin: 25px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .input-group input {
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1.1rem;
            width: 350px;
            outline: none;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .input-group input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .game-screen {
            display: none;
            padding: 30px;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
        }
        
        /* Word Guess Challenge Styles */
        .word-guess-container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        .wgc-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .wgc-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .wgc-header p {
            opacity: 0.9;
        }
        
        .wgc-content {
            padding: 40px;
        }
        
        .wgc-file-section {
            margin-bottom: 40px;
            text-align: center;
        }
        
        .wgc-load-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        
        .wgc-load-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
        }
        
        .wgc-start-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 20px rgba(79, 172, 254, 0.3);
            margin-left: 15px;
        }
        
        .wgc-start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(79, 172, 254, 0.4);
        }
        
        .wgc-file-hint {
            margin-top: 15px;
            color: #718096;
            font-size: 0.9rem;
        }
        
        .wgc-timer-section {
            margin-bottom: 40px;
        }
        
        .wgc-timer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .wgc-timer-label {
            font-weight: 600;
            color: #4a5568;
        }
        
        .wgc-timer-value {
            font-weight: 700;
            color: #667eea;
            font-size: 1.1rem;
        }
        
        .wgc-timer-bar-container {
            width: 100%;
            background: #e2e8f0;
            border-radius: 12px;
            height: 12px;
            overflow: hidden;
        }
        
        .wgc-timer-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            transition: width 0.1s linear;
        }
        
        .wgc-definition-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }
        
        .wgc-definition-label {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 12px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .wgc-definition-text {
            font-size: 1.3rem;
            font-weight: 500;
            color: #4a5568;
            line-height: 1.6;
        }
        
        .wgc-input-section {
            margin-bottom: 40px;
        }
        
        .wgc-input-label {
            display: block;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 12px;
        }
        
        .wgc-input-container {
            display: flex;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .wgc-input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            font-size: 1.1rem;
            outline: none;
        }
        
        .wgc-submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .wgc-submit-btn:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        
        .wgc-button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .wgc-hint-btn {
            flex: 1;
            padding: 15px;
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .wgc-hint-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(250, 112, 154, 0.3);
        }
        
        .wgc-next-btn {
            flex: 1;
            padding: 15px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .wgc-next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(79, 172, 254, 0.3);
        }
        
        .wgc-skip-btn {
            flex: 1;
            padding: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .wgc-skip-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(240, 147, 251, 0.3);
        }
        
        .wgc-next-word-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
            display: none;
        }
        
        .wgc-next-word-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(79, 172, 254, 0.4);
        }
        
        .wgc-feedback {
            margin-bottom: 40px;
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        
        .wgc-feedback.success {
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
            color: #2d6a4f;
        }
        
        .wgc-feedback.error {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .wgc-feedback.warning {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #856404;
        }
        
        .wgc-stats {
            display: flex;
            justify-content: space-between;
            padding-top: 30px;
            border-top: 1px solid #e2e8f0;
            color: #718096;
            font-size: 0.9rem;
        }
        
        .wgc-stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .wgc-stat-value {
            font-weight: 700;
            color: #4a5568;
        }
        
        .hidden {
            display: none !important;
        }
        
        @media (max-width: 768px) {
            .wgc-content {
                padding: 30px 20px;
            }
            
            .wgc-button-group {
                flex-direction: column;
            }
            
            .wgc-header h1 {
                font-size: 2rem;
            }
            
            .input-group input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="settings-icon" onclick="openSettings()">
                <i class="fas fa-cog"></i>
            </div>
            <h1>TABOGAME</h1>
            <p id="game-mode-header">Single Player Word Game</p>
        </header>
        
        <!-- Mode Selection Screen -->
        <div class="setup-screen" id="mode-screen">
            <h2>Select Game Mode</h2>
            <div class="mode-selection">
                <div class="mode-card solo-card" onclick="selectMode('solo')">
                    <i class="fas fa-user fa-3x"></i>
                    <h3>Single Player</h3>
                    <p>Guess words from descriptions</p>
                </div>
            </div>
        </div>
        
        <!-- Player Name Screen -->
        <div class="setup-screen" id="name-screen" style="display: none;">
            <h2>Enter Your NickName</h2>
            <div class="input-group">
                <input type="text" id="player-name" placeholder="Your name" maxlength="15">
                <p class="hotkey-hint">Press Enter to continue</p>
            </div>
            
            <button class="btn btn-primary" onclick="submitName()">Continue</button>
            <button class="btn btn-secondary" onclick="switchScreen('mode-screen')">Back</button>
        </div>
        
        <!-- Game Screen -->
        <div class="game-screen" id="game-screen">
            <div class="game-header" id="game-header-single">
                <span id="player-info-single">Single Player Mode</span>
                <div>
                    <button class="btn btn-danger" onclick="resetGame()">Reset Game</button>
                </div>
            </div>
            
            <!-- Word Guess Challenge Interface (Single Player Only) -->
            <div id="word-guess-challenge">
                <div class="word-guess-container">
                    <!-- Header -->
                    <div class="wgc-header">
                        <h1>Word Guess Challenge</h1>
                        <p>Guess the word before time runs out!</p>
                    </div>
                    
                    <!-- Game Area -->
                    <div class="wgc-content">
                        <!-- Load File Button -->
                        <div id="file-load-section" class="wgc-file-section">
                            <button id="load-file" class="wgc-load-btn">
                                <i class="fas fa-file-upload"></i>
                                Load Words File
                            </button>
                            <button id="start-game" class="wgc-start-btn" onclick="startWordGuessChallenge()">
                                <i class="fas fa-play"></i>
                                Start Game
                            </button>
                            <p class="wgc-file-hint">Select a text file with words and descriptions</p>
                            <input type="file" id="word-file" accept=".txt" style="display: none;">
                        </div>
                        
                        <!-- Timer -->
                        <div class="wgc-timer-section hidden" id="timer-section">
                            <div class="wgc-timer-header">
                                <span class="wgc-timer-label">Time remaining:</span>
                                <span id="time" class="wgc-timer-value">10</span>
                            </div>
                            <div class="wgc-timer-bar-container">
                                <div id="timer-bar" class="wgc-timer-bar" style="width: 100%"></div>
                            </div>
                        </div>
                        
                        <!-- Description -->
                        <div class="wgc-definition-section">
                            <div class="wgc-definition-label">DESCRIPTION</div>
                            <p id="definition" class="wgc-definition-text">Please select your words.txt file or click 'Start Game' to begin with default words...</p>
                        </div>
                        
                        <!-- Input Area -->
                        <div class="wgc-input-section hidden" id="input-section">
                            <label for="guess" class="wgc-input-label">Enter word:</label>
                            <div class="wgc-input-container">
                                <input type="text" id="guess" autocomplete="off" class="wgc-input"
                                    placeholder="Type your guess...">
                                <button id="submit" class="wgc-submit-btn">Submit</button>
                            </div>
                            
                            <div class="wgc-button-group">
                                <button id="hint-btn" class="wgc-hint-btn">
                                    <i class="fas fa-lightbulb"></i>
                                    Hint
                                </button>
                                <button id="next-word-btn" class="wgc-next-btn">
                                    <i class="fas fa-forward"></i>
                                    Next Word
                                </button>
                                <button id="skip-btn" class="wgc-skip-btn">
                                    <i class="fas fa-fast-forward"></i>
                                    Skip
                                </button>
                            </div>
                            
                            <button id="next-btn" class="wgc-next-word-btn">
                                <i class="fas fa-arrow-right"></i>
                                Next Word
                            </button>
                        </div>
                        
                        <!-- Feedback -->
                        <div id="feedback" class="wgc-feedback"></div>
                        
                        <!-- Stats -->
                        <div class="wgc-stats hidden" id="stats-section">
                            <div class="wgc-stat-item">
                                <i class="fas fa-star"></i>
                                Score: <span id="score-wgc" class="wgc-stat-value">0</span>
                            </div>
                            <div class="wgc-stat-item">
                                <i class="fas fa-fire"></i>
                                Streak: <span id="streak" class="wgc-stat-value">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Game state
        let gameActive = false;
        let playerName = '';
        let gameMode = 'solo';
        
        // Word Guess Challenge state
        let wordData = [];
        let usedIndices = [];
        let currentWord = "";
        let scoreWGC = 0;
        let streak = 0;
        let timeLeftWGC = 10;
        let timerWGC = null;
        let gameActiveWGC = false;
        let hintUsed = false;
        let revealedLetters = [];
        let gameStarted = false;
        
        // Game settings with default values
        let gameSettings = {
            timerDuration: 10
        };
        
        // Default word list
        const defaultWords = [
            "apple - A round fruit with red or green skin",
            "banana - A long curved fruit with yellow skin",
            "orange - A round citrus fruit with orange skin",
            "grape - A small round fruit that grows in bunches",
            "melon - A large juicy fruit with sweet flesh",
            "computer - An electronic device for storing and processing data",
            "keyboard - A set of keys on a computer used to type",
            "mouse - A small handheld device used to control cursor",
            "monitor - A screen used to display computer output",
            "laptop - A portable computer that can be used on your lap",
            "river - A natural flowing watercourse",
            "mountain - A large natural elevation of the earth's surface",
            "forest - A large area covered chiefly with trees",
            "ocean - A very large expanse of sea",
            "desert - A barren area of landscape with little precipitation",
            "book - A written or printed work consisting of pages",
            "pencil - A writing instrument with a solid pigment core",
            "paper - Material manufactured in thin sheets from wood pulp",
            "teacher - A person who teaches in a school",
            "student - A person who is studying at a school or college"
        ];
        
        // DOM elements
        const modeScreen = document.getElementById('mode-screen');
        const nameScreen = document.getElementById('name-screen');
        const gameScreen = document.getElementById('game-screen');
        const playerNameInput = document.getElementById('player-name');
        const gameModeHeader = document.getElementById('game-mode-header');
        
        // Word Guess Challenge DOM elements
        const definitionEl = document.getElementById('definition');
        const guessWgcEl = document.getElementById('guess');
        const submitWgcBtn = document.getElementById('submit');
        const nextWgcBtn = document.getElementById('next-btn');
        const nextWordBtn = document.getElementById('next-word-btn');
        const skipBtn = document.getElementById('skip-btn');
        const hintBtn = document.getElementById('hint-btn');
        const feedbackWgcEl = document.getElementById('feedback');
        const scoreWgcEl = document.getElementById('score-wgc');
        const streakEl = document.getElementById('streak');
        const timeWgcEl = document.getElementById('time');
        const timerBarEl = document.getElementById('timer-bar');
        const fileLoadSection = document.getElementById('file-load-section');
        const timerSection = document.getElementById('timer-section');
        const inputSection = document.getElementById('input-section');
        const statsSection = document.getElementById('stats-section');
        const startGameBtn = document.getElementById('start-game');
        const wordFileInput = document.getElementById('word-file');
        
        // Initialize the game when the page loads
        window.onload = function() {
            // Show the mode selection screen
            switchScreen('mode-screen');
            
            // Set up keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    if (document.getElementById('name-screen').style.display !== 'none') {
                        submitName();
                    } else if (gameMode === 'solo' && gameActiveWGC) {
                        checkGuess();
                    }
                }
            });
            
            // Initialize Word Guess Challenge event listeners
            submitWgcBtn.addEventListener('click', checkGuess);
            nextWgcBtn.addEventListener('click', loadNextWord);
            hintBtn.addEventListener('click', showHint);
            skipBtn.addEventListener('click', skipWord);
            nextWordBtn.addEventListener('click', loadNextWord);
            
            // Set up file input for Word Guess Challenge
            wordFileInput.addEventListener('change', handleFileSelect);
            
            // Set up the load file button for Word Guess Challenge
            document.getElementById('load-file').addEventListener('click', () => {
                wordFileInput.click();
            });
            
            // Add event listener for Enter key on guess input in single player mode
            guessWgcEl.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && gameActiveWGC) {
                    checkGuess();
                }
            });
        };
        
        // Function to switch between screens
        function switchScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.setup-screen, .game-screen').forEach(screen => {
                screen.style.display = 'none';
            });
            
            // Show the selected screen
            document.getElementById(screenId).style.display = 'block';
        }
        
        // Function to select a game mode
        function selectMode(mode) {
            gameMode = mode;
            submitMode();
        }
        
        // Function to submit the selected mode and proceed
        function submitMode() {
            switchScreen('name-screen');
        }
        
        // Function to submit the player name
        function submitName() {
            playerName = playerNameInput.value.trim();
            
            if (!playerName) {
                alert('Please enter your name');
                return;
            }
            
            // Clear the name input field
            playerNameInput.value = '';
            
            if (gameMode === 'solo') {
                startSoloGame();
            }
        }
        
        // Function to start the solo game
        function startSoloGame() {
            switchScreen('game-screen');
            
            // Initialize the Word Guess Challenge game
            initWordGuessChallenge();
        }
        
        // Function to initialize the Word Guess Challenge game
        function initWordGuessChallenge() {
            // Load the default words
            wordData = defaultWords.map(word => {
                const parts = word.split(' - ');
                return {
                    word: parts[0],
                    definition: parts[1]
                };
            });
            
            usedIndices = [];
            scoreWGC = 0;
            streak = 0;
            gameStarted = false;
            updateStats();
            
            // Show the file load section
            fileLoadSection.style.display = 'block';
            
            // Hide the timer, input, and stats sections
            timerSection.classList.add('hidden');
            inputSection.classList.add('hidden');
            statsSection.classList.add('hidden');
            
            // Set the definition text
            definitionEl.textContent = "Click 'Start Game' to begin playing!";
        }
        
        // Function to start the Word Guess Challenge game
        function startWordGuessChallenge() {
            if (!gameStarted) {
                gameStarted = true;
                
                // Hide the file load section
                fileLoadSection.style.display = 'none';
                
                // Show the timer, input, and stats sections
                timerSection.classList.remove('hidden');
                inputSection.classList.remove('hidden');
                statsSection.classList.remove('hidden');
                
                // Load the first word
                loadNextWord();
            }
        }
        
        // Function to handle file selection
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                parseWordFile(content);
            };
            reader.readAsText(file);
        }
        
        // Function to parse the word file
        function parseWordFile(content) {
            const lines = content.split('\n');
            const newWordData = [];
            
            for (const line of lines) {
                const trimmedLine = line.trim();
                if (trimmedLine) {
                    const parts = trimmedLine.split(' - ');
                    if (parts.length >= 2) {
                        newWordData.push({
                            word: parts[0].trim(),
                            definition: parts[1].trim()
                        });
                    }
                }
            }
            
            if (newWordData.length > 0) {
                wordData = newWordData;
                alert(`Loaded ${wordData.length} words from file`);
                definitionEl.textContent = "Words loaded! Click 'Start Game' to begin playing!";
            } else {
                alert('No valid words found in the file');
            }
        }
        
        // Function to load the next word
        function loadNextWord() {
            // Reset hint state
            hintUsed = false;
            revealedLetters = [];
            
            // If we've used all words, reset the used indices
            if (usedIndices.length >= wordData.length) {
                usedIndices = [];
            }
            
            // Get a random word that hasn't been used yet
            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * wordData.length);
            } while (usedIndices.includes(randomIndex));
            
            usedIndices.push(randomIndex);
            currentWord = wordData[randomIndex];
            
            // Display the definition
            definitionEl.textContent = currentWord.definition;
            
            // Clear the guess input - FIX 1: Clear input when loading new word
            guessWgcEl.value = '';
            
            // Hide the feedback and next button
            feedbackWgcEl.style.display = 'none';
            feedbackWgcEl.className = 'wgc-feedback';
            nextWgcBtn.style.display = 'none';
            
            // Reset the timer - FIX 2: Use gameSettings.timerDuration
            timeLeftWGC = gameSettings.timerDuration;
            updateTimerDisplay();
            
            // Start the timer
            startTimer();
            
            // Focus on the guess input
            guessWgcEl.focus();
        }
        
        // Function to skip the current word
        function skipWord() {
            if (!gameActiveWGC) return;
            
            // Stop the timer
            clearInterval(timerWGC);
            gameActiveWGC = false;
            
            // Show feedback that the word was skipped
            showFeedback('Skipped! The word was: ' + currentWord.word, 'warning');
            
            // Show the next button
            nextWgcBtn.style.display = 'block';
            
            // Reset streak
            streak = 0;
            updateStats();
            
            // Clear the input field - FIX 1: Clear input when skipping
            guessWgcEl.value = '';
        }
        
        // Function to start the timer
        function startTimer() {
            // Clear any existing timer - FIX 2: Ensure timer is properly cleared
            if (timerWGC) {
                clearInterval(timerWGC);
                timerWGC = null;
            }
            
            gameActiveWGC = true;
            
            // Reset timer to initial value - FIX 2: Use gameSettings.timerDuration
            timeLeftWGC = gameSettings.timerDuration;
            
            // Update timer display immediately
            updateTimerDisplay();
            
            // Set up the timer interval
            timerWGC = setInterval(() => {
                timeLeftWGC--;
                updateTimerDisplay();
                
                if (timeLeftWGC <= 0) {
                    // Clear the timer
                    clearInterval(timerWGC);
                    timerWGC = null;
                    gameActiveWGC = false;
                    
                    // Show the right answer when timer expires
                    showFeedback('Time\'s up! The word was: ' + currentWord.word, 'error');
                    nextWgcBtn.style.display = 'block';
                    streak = 0;
                    updateStats();
                    
                    // Clear the input field - FIX 1: Clear input when time expires
                    guessWgcEl.value = '';
                }
            }, 1000);
        }
        
        // Function to update the timer display
        function updateTimerDisplay() {
            // Update the timer text
            timeWgcEl.textContent = timeLeftWGC;
            
            // Calculate the percentage for the progress bar - FIX 2: Use gameSettings.timerDuration
            const maxTime = gameSettings.timerDuration;
            const percentage = (timeLeftWGC / maxTime) * 100;
            timerBarEl.style.width = percentage + '%';
            
            // Change color based on time left
            if (percentage > 50) {
                timerBarEl.style.background = 'linear-gradient(90deg, #667eea 0%, #764ba2 100%)';
            } else if (percentage > 20) {
                timerBarEl.style.background = 'linear-gradient(90deg, #fa709a 0%, #fee140 100%)';
            } else {
                timerBarEl.style.background = 'linear-gradient(90deg, #f093fb 0%, #f5576c 100%)';
            }
        }
        
        // Function to check the guess
        function checkGuess() {
            if (!gameActiveWGC) return;
            
            const guess = guessWgcEl.value.trim();
            const correctWord = currentWord.word.toLowerCase();
            
            if (guess.toLowerCase() === correctWord) {
                // Correct guess
                clearInterval(timerWGC);
                timerWGC = null;
                gameActiveWGC = false;
                
                // Calculate score based on time left
                const points = Math.max(1, Math.floor(timeLeftWGC));
                scoreWGC += points;
                streak++;
                
                showFeedback('Correct! +' + points + ' points', 'success');
                nextWgcBtn.style.display = 'block';
                updateStats();
                
                // Clear the input field after correct guess - FIX 1: Clear input after submission
                guessWgcEl.value = '';
            } else {
                // Incorrect guess
                showFeedback('Incorrect. Try again!', 'error');
                // Clear the input field for the next guess - FIX 1: Clear input after submission
                guessWgcEl.value = '';
                guessWgcEl.focus();
            }
        }
        
        // Function to show feedback
        function showFeedback(message, type) {
            feedbackWgcEl.textContent = message;
            feedbackWgcEl.className = 'wgc-feedback ' + type;
            feedbackWgcEl.style.display = 'block';
        }
        
        // Function to show a hint
        function showHint() {
            if (!gameActiveWGC) return;
            
            hintUsed = true;
            const word = currentWord.word.toLowerCase();
            
            // If no letters have been revealed yet, initialize the array
            if (revealedLetters.length === 0) {
                // Reveal a random letter - FIX 3: Ensure we reveal a random letter
                const randomIndex = Math.floor(Math.random() * word.length);
                revealedLetters.push(randomIndex);
            } else {
                // Reveal a random letter that hasn't been revealed yet - FIX 3: Ensure we don't reveal the same letter twice
                const unrevealedIndices = [];
                for (let i = 0; i < word.length; i++) {
                    if (!revealedLetters.includes(i)) {
                        unrevealedIndices.push(i);
                    }
                }
                
                if (unrevealedIndices.length > 0) {
                    const randomIndex = unrevealedIndices[Math.floor(Math.random() * unrevealedIndices.length)];
                    revealedLetters.push(randomIndex);
                } else {
                    // All letters are already revealed
                    showFeedback('All letters are already revealed!', 'warning');
                    return;
                }
            }
            
            // Create a hint string with underscores for unrevealed letters
            let hint = '';
            for (let i = 0; i < word.length; i++) {
                if (revealedLetters.includes(i)) {
                    hint += word[i].toUpperCase() + ' ';
                } else {
                    hint += '_ ';
                }
            }
            
            // Remove trailing space
            hint = hint.trim();
            
            showFeedback('Hint: ' + hint, 'warning');
            
            // Deduct points for using a hint
            scoreWGC = Math.max(0, scoreWGC - 2);
            updateStats();
        }
        
        // Function to update the stats display
        function updateStats() {
            scoreWgcEl.textContent = scoreWGC;
            streakEl.textContent = streak;
        }
        
        // Function to open settings
        function openSettings() {
            alert('Settings would open here. In a full implementation, this would allow changing game options.');
        }
        
        // Function to reset the game
        function resetGame() {
            // Stop any active timers
            if (timerWGC) {
                clearInterval(timerWGC);
                timerWGC = null;
            }
            
            // Reset game state
            gameActiveWGC = false;
            
            // Reinitialize the game
            initWordGuessChallenge();
        }
    </script>
</body>
</html>
