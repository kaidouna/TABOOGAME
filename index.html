<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaboGame - Enhanced Mobile Experience</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            color: #333;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
            backdrop-filter: blur(10px);
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .settings-icon {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 1.3rem;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .settings-icon:hover {
            transform: rotate(45deg);
            background: rgba(255, 255, 255, 0.3);
        }
        
        .setup-screen {
            padding: 30px;
            text-align: center;
        }
        
        .setup-screen h2 {
            color: #4a5568;
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .input-group {
            margin: 20px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .input-group input {
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1.1rem;
            width: 100%;
            max-width: 400px;
            outline: none;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .input-group input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .game-screen {
            display: none;
            padding: 20px;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
        }
        
        /* Word Guess Challenge Styles */
        .word-guess-container {
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .wgc-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .wgc-header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .wgc-content {
            padding: 30px;
        }
        
        .wgc-file-section {
            margin-bottom: 30px;
            text-align: center;
        }
        
        .wgc-start-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 20px rgba(79, 172, 254, 0.3);
        }
        
        .wgc-start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(79, 172, 254, 0.4);
        }
        
        .wgc-timer-section {
            margin-bottom: 30px;
        }
        
        .wgc-timer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .wgc-timer-label {
            font-weight: 600;
            color: #4a5568;
        }
        
        .wgc-timer-value {
            font-weight: 700;
            color: #667eea;
            font-size: 1.1rem;
        }
        
        .wgc-timer-bar-container {
            width: 100%;
            background: #e2e8f0;
            border-radius: 12px;
            height: 12px;
            overflow: hidden;
        }
        
        .wgc-timer-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            transition: width 0.1s linear;
        }
        
        .wgc-definition-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 18px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }
        
        .wgc-definition-label {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 12px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .wgc-definition-text {
            font-size: 1.2rem;
            font-weight: 500;
            color: #4a5568;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .words-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .word-item {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #4a5568;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .word-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }
        
        .word-item.correct {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .word-item.skipped {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .word-text {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .word-dropdown {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background: white;
            color: #4a5568;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .wgc-input-section {
            margin-bottom: 30px;
        }
        
        .wgc-button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
            min-width: 150px;
        }
        
        .next-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(79, 172, 254, 0.3);
        }
        
        .skip-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .skip-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(240, 147, 251, 0.3);
        }
        
        .copy-btn {
            background: linear-gradient(135deg, #0ba360 0%, #3cba92 100%);
            color: white;
            width: 100%;
            padding: 18px;
            margin-bottom: 20px;
            display: none;
        }
        
        .copy-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(11, 163, 96, 0.4);
        }
        
        .wgc-feedback {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        
        .wgc-feedback.success {
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
            color: #2d6a4f;
        }
        
        .wgc-feedback.error {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .wgc-feedback.warning {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #856404;
        }
        
        .player-list {
            margin: 20px 0;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 15px;
        }
        
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .player-item:last-child {
            border-bottom: none;
        }
        
        .player-name {
            font-weight: 500;
        }
        
        .remove-player {
            color: #f5576c;
            cursor: pointer;
            padding: 5px;
        }
        
        .scoreboard {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }
        
        .scoreboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .scoreboard-title {
            font-weight: 700;
            color: #4a5568;
            font-size: 1.2rem;
        }
        
        .scoreboard-round {
            font-weight: 600;
            color: #667eea;
        }
        
        .scoreboard-list {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 10px 5px;
        }
        
        .scoreboard-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            min-width: 120px;
        }
        
        .scoreboard-player {
            font-weight: 500;
            margin-bottom: 8px;
            text-align: center;
        }
        
        .scoreboard-score {
            font-weight: 700;
            color: #667eea;
            font-size: 1.4rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 12px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Settings Modal Styles */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .settings-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 15px;
        }
        
        .settings-header h2 {
            color: #4a5568;
            font-size: 1.6rem;
            font-weight: 600;
        }
        
        .close-settings {
            font-size: 1.5rem;
            cursor: pointer;
            color: #a0aec0;
            transition: color 0.3s ease;
        }
        
        .close-settings:hover {
            color: #4a5568;
        }
        
        .setting-item {
            margin-bottom: 25px;
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .setting-item input[type="range"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .setting-item input[type="range"]:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .setting-item .value-display {
            margin-top: 8px;
            font-size: 0.9rem;
            color: #718096;
        }
        
        .setting-description {
            margin-top: 8px;
            font-size: 0.9rem;
            color: #718096;
            line-height: 1.5;
        }
        
        .save-settings {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .save-settings:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        /* Player Listbox Styles */
        .player-listbox {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            margin-top: 10px;
            resize: vertical;
            min-height: 100px;
        }
        
        .player-listbox:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        /* Responsive styles */
        @media (max-width: 1024px) {
            .words-container {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 16px;
            }
            
            .game-screen {
                padding: 15px;
            }
            
            .wgc-content {
                padding: 20px;
            }
            
            .wgc-button-group {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
            }
            
            .word-item {
                min-height: 100px;
                padding: 12px;
            }
            
            .word-text {
                font-size: 1rem;
            }
            
            .word-dropdown {
                padding: 8px;
                font-size: 0.85rem;
            }
            
            .game-header {
                padding: 12px 15px;
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .scoreboard-item {
                min-width: 100px;
                padding: 12px;
            }
            
            .scoreboard-player {
                font-size: 0.9rem;
            }
            
            .scoreboard-score {
                font-size: 1.2rem;
            }
        }
        
        @media (max-width: 480px) {
            header {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .settings-icon {
                top: 10px;
                left: 10px;
                width: 35px;
                height: 35px;
            }
            
            .wgc-header {
                padding: 20px;
            }
            
            .wgc-header h1 {
                font-size: 1.6rem;
            }
            
            .words-container {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
                gap: 10px;
            }
            
            .word-item {
                min-height: 90px;
                padding: 10px;
            }
            
            .word-text {
                font-size: 0.9rem;
            }
            
            .wgc-definition-text {
                font-size: 1.1rem;
            }
            
            .scoreboard-item {
                min-width: 90px;
                padding: 10px;
            }
            
            .scoreboard-player {
                font-size: 0.85rem;
            }
            
            .scoreboard-score {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="settings-icon" onclick="openSettings()">
                <i class="fas fa-cog"></i>
            </div>
            <h1>TABOGAME</h1>
            <p>Multiplayer Word Game</p>
        </header>
        
        <!-- Player Name Screen -->
        <div class="setup-screen" id="name-screen">
            <h2>Game Setup</h2>
            
            <div class="input-group">
                <label>Game Instructions</label>
                <div style="text-align: left; background: #f5f7fa; padding: 20px; border-radius: 12px; margin: 15px 0;">
                    <p><strong>How to play:</strong></p>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Add players using the "New Player" button</li>
                        <li>Click "Continue" to start the game</li>
                        <li>As the describer, you'll see words to describe to other players</li>
                        <li>Use the dropdown menus to award points to players who guess correctly</li>
                        <li>The scoreboard at the bottom will update in real time</li>
                        <li>Use "Copy to FFT" to copy the results</li>
                    </ol>
                </div>
            </div>
            
            <div class="input-group">
                <label for="player-name">Describer Name</label>
                <input type="text" id="player-name" placeholder="Your name" maxlength="15">
            </div>
            
            <div>
                <button class="btn btn-primary" onclick="submitName()">Continue</button>
                <button class="btn btn-secondary" onclick="showPlayerListbox()">New Player(s)</button>
            </div>
            
            <div class="player-list" id="player-list">
                <div class="player-item" style="font-weight: bold;">
                    <span>Player Name</span>
                    <span>Score</span>
                </div>
                <!-- Players will be added here dynamically -->
            </div>
        </div>
        
        <!-- Game Screen -->
        <div class="game-screen" id="game-screen">
            <div class="game-header">
                <span id="player-info">Player Name</span>
                <div>
                    <span id="round-counter" style="margin-right: 15px;">Round: 1</span>
                    <button class="btn btn-danger" onclick="resetGame()">Reset Game</button>
                </div>
            </div>
            
            <!-- Word Guess Challenge Interface -->
            <div id="word-guess-challenge">
                <div class="word-guess-container">
                    <!-- Header -->
                    <div class="wgc-header">
                        <h1>Word Guess Challenge</h1>
                        <p>Describe the words to your team without saying them directly!</p>
                    </div>
                    
                    <!-- Game Area -->
                    <div class="wgc-content">
                        <!-- Start Game Button -->
                        <div id="file-load-section" class="wgc-file-section">
                            <button id="start-game" class="wgc-start-btn" onclick="startWordGuessChallenge()">
                                <i class="fas fa-play"></i>
                                Start Game
                            </button>
                            <p class="wgc-file-hint">Use the settings icon to load a custom word list</p>
                        </div>
                        
                        <!-- Timer -->
                        <div class="wgc-timer-section hidden" id="timer-section">
                            <div class="wgc-timer-header">
                                <span class="wgc-timer-label">Time remaining:</span>
                                <span id="time" class="wgc-timer-value">90</span>
                            </div>
                            <div class="wgc-timer-bar-container">
                                <div id="timer-bar" class="wgc-timer-bar" style="width: 100%"></div>
                            </div>
                        </div>
                        
                        <!-- Description -->
                        <div class="wgc-definition-section">
                            <div class="wgc-definition-label">WORDS TO DESCRIBE</div>
                            <p id="definition" class="wgc-definition-text">Click 'Start Game' to begin playing with default words...</p>
                            <div class="words-container" id="words-container">
                                <!-- Words will be displayed here -->
                            </div>
                        </div>
                        
                        <!-- Input Area -->
                        <div class="wgc-input-section hidden" id="input-section">
                            <div class="wgc-button-group">
                                <button id="next-word-btn" class="action-btn next-btn" onclick="nextRound()">
                                    <i class="fas fa-forward"></i>
                                    Next Round
                                </button>
                                <button id="skip-btn" class="action-btn skip-btn" onclick="skipWordSet()">
                                    <i class="fas fa-fast-forward"></i>
                                    Skip Set
                                </button>
                            </div>
                            
                            <button id="copy-btn" class="action-btn copy-btn" onclick="copyToFFT()">
                                <i class="fas fa-copy"></i>
                                Copy Result
                            </button>
                        </div>
                        
                        <!-- Feedback -->
                        <div id="feedback" class="wgc-feedback"></div>
                    </div>
                </div>
            </div>
            
            <!-- Scoreboard -->
            <div class="scoreboard">
                <div class="scoreboard-header">
                    <div class="scoreboard-title">Scoreboard</div>
                    <div class="scoreboard-round" id="round-display">Round: 1</div>
                </div>
                <div class="scoreboard-list" id="scoreboard">
                    <!-- Scoreboard items will be added here dynamically -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Settings Modal -->
    <div class="settings-modal" id="settings-modal">
        <div class="settings-content">
            <div class="settings-header">
                <h2>Game Settings</h2>
                <div class="close-settings" onclick="closeSettings()">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            
            <div class="setting-item">
                <label for="timer-duration">Timer Duration (seconds)</label>
                <input type="range" id="timer-duration" min="10" max="180" value="90" step="10">
                <div class="value-display" id="timer-duration-value">90 seconds</div>
                <div class="setting-description">
                    Adjust the time limit for each word. Shorter durations (10-30 seconds) create a fast-paced game, 
                    while longer durations (60-180 seconds) allow for more detailed descriptions and strategic thinking.
                </div>
            </div>
            
            <div class="setting-item">
                <label for="words-count">Number of Words to Show</label>
                <input type="range" id="words-count" min="1" max="20" value="20" step="1">
                <div class="value-display" id="words-count-value">20 words</div>
                <div class="setting-description">
                    Control how many words are displayed to the describer at once. Fewer words (1-3) make the game easier, 
                    while more words (5-20) increase the challenge by giving the describer more options to describe.
                </div>
            </div>
            
            <!-- File Upload in Settings -->
            <div class="setting-item">
                <label>Load Custom Words</label>
                <button class="wgc-load-btn" onclick="document.getElementById('settings-word-file').click()" style="width: 100%;">
                    <i class="fas fa-file-upload"></i>
                    Load Words File
                </button>
                <input type="file" id="settings-word-file" accept=".txt" style="display: none;" onchange="handleFileSelect(event)">
                <div class="setting-description">
                    Select a text file with words and descriptions (one per line, format: "word - description").
                </div>
            </div>
            
            <!-- Player Management in Settings -->
            <div class="setting-item">
                <label>Player Management</label>
                <div class="player-list" id="settings-player-list">
                    <div class="player-item" style="font-weight: bold;">
                        <span>Player Name</span>
                        <span>Action</span>
                    </div>
                    <!-- Players will be added here dynamically -->
                </div>
                <button class="btn btn-secondary" onclick="showPlayerListbox()" style="width: 100%; margin-top: 10px;">
                    <i class="fas fa-plus"></i> Add New Player(s)
                </button>
            </div>
            
            <button class="save-settings" onclick="saveSettings()">Save Settings</button>
        </div>
    </div>
    
    <!-- Player Listbox Modal -->
    <div class="settings-modal" id="player-modal">
        <div class="settings-content">
            <div class="settings-header">
                <h2>Add Players</h2>
                <div class="close-settings" onclick="closePlayerModal()">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            
            <div class="setting-item">
                <label for="player-listbox">Enter player names (one per line):</label>
                <textarea class="player-listbox" id="player-listbox" placeholder="Enter player names, one per line"></textarea>
            </div>
            
            <button class="save-settings" onclick="addPlayersFromListbox()">Add Players</button>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">Results copied to clipboard!</div>
    
    <script>
        // Game state
        let playerName = '';
        let players = []; // Start with empty player list
        let currentRound = 1;
        
        // Word Guess Challenge state
        let wordData = [];
        let usedIndices = [];
        let currentWords = [];
        let timeLeftWGC = 90;
        let timerWGC = null;
        let gameActiveWGC = false;
        let gameStarted = false;
        
        // Game settings with default values (90 seconds and 20 words)
        let gameSettings = {
            timerDuration: 90,
            wordsCount: 20
        };
        
        // Default word list
        const defaultWords = [
            "Apple - A fruit that grows on trees",
            "Banana - A long yellow fruit",
            "Carrot - A orange vegetable that grows underground",
            "Dolphin - A intelligent marine mammal",
            "Elephant - A large animal with a trunk",
            "Flower - The colorful part of a plant",
            "Guitar - A musical instrument with strings",
            "House - A building where people live",
            "Island - Land surrounded by water",
            "Jungle - A dense tropical forest",
            "Kangaroo - An Australian animal that hops",
            "Lemon - A sour yellow citrus fruit",
            "Mountain - A very high natural place",
            "Notebook - A book for writing notes",
            "Ocean - A very large body of salt water",
            "Piano - A large musical instrument with keys",
            "Queen - A female ruler of a country",
            "River - A natural flowing watercourse",
            "Sun - The star that Earth orbits",
            "Tree - A tall plant with a trunk and branches"
        ];
        
        // DOM elements
        const nameScreen = document.getElementById('name-screen');
        const gameScreen = document.getElementById('game-screen');
        const playerNameInput = document.getElementById('player-name');
        const playerInfoEl = document.getElementById('player-info');
        const playerListEl = document.getElementById('player-list');
        const scoreboardEl = document.getElementById('scoreboard');
        const roundCounterEl = document.getElementById('round-counter');
        const roundDisplayEl = document.getElementById('round-display');
        
        // Word Guess Challenge DOM elements
        const definitionEl = document.getElementById('definition');
        const wordsContainerEl = document.getElementById('words-container');
        const fileLoadSection = document.getElementById('file-load-section');
        const timerSection = document.getElementById('timer-section');
        const inputSection = document.getElementById('input-section');
        const feedbackWgcEl = document.getElementById('feedback');
        const timeWgcEl = document.getElementById('time');
        const timerBarEl = document.getElementById('timer-bar');
        const startGameBtn = document.getElementById('start-game');
        
        // Settings DOM elements
        const settingsModal = document.getElementById('settings-modal');
        const timerDurationSlider = document.getElementById('timer-duration');
        const timerDurationValue = document.getElementById('timer-duration-value');
        const wordsCountSlider = document.getElementById('words-count');
        const wordsCountValue = document.getElementById('words-count-value');
        const settingsPlayerListEl = document.getElementById('settings-player-list');
        
        // Player modal elements
        const playerModal = document.getElementById('player-modal');
        const playerListbox = document.getElementById('player-listbox');
        
        // Notification element
        const notification = document.getElementById('notification');
        
        // Initialize the game when the page loads
        window.onload = function() {
            // Show the name screen
            nameScreen.style.display = 'block';
            
            // Update player list (empty initially)
            updatePlayerList();
            
            // Set up keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    if (nameScreen.style.display !== 'none') {
                        submitName();
                    }
                }
            });
            
            // Set up settings sliders
            timerDurationSlider.addEventListener('input', function() {
                timerDurationValue.textContent = this.value + ' seconds';
            });
            
            wordsCountSlider.addEventListener('input', function() {
                wordsCountValue.textContent = this.value + (this.value == 1 ? ' word' : ' words');
            });
        };
        
        // Function to show player listbox modal
        function showPlayerListbox() {
            playerListbox.value = '';
            playerModal.style.display = 'flex';
        }
        
        // Function to close player modal
        function closePlayerModal() {
            playerModal.style.display = 'none';
        }
        
        // Function to add players from listbox
        function addPlayersFromListbox() {
            const names = playerListbox.value.split('\n');
            let added = 0;
            
            for (const name of names) {
                const trimmedName = name.trim();
                if (trimmedName && !players.some(p => p.name === trimmedName)) {
                    players.push({
                        name: trimmedName,
                        score: 0
                    });
                    added++;
                }
            }
            
            if (added > 0) {
                updatePlayerList();
                closePlayerModal();
            } else {
                alert('No valid new players to add.');
            }
        }
        
        // Function to update the player list
        function updatePlayerList() {
            playerListEl.innerHTML = `
                <div class="player-item" style="font-weight: bold;">
                    <span>Player Name</span>
                    <span>Score</span>
                </div>
            `;
            
            players.forEach((player, index) => {
                const playerEl = document.createElement('div');
                playerEl.className = 'player-item';
                playerEl.innerHTML = `
                    <span class="player-name">${player.name}</span>
                    <span>${player.score}</span>
                    <span class="remove-player" onclick="removePlayer(${index})">
                        <i class="fas fa-times"></i>
                    </span>
                `;
                playerListEl.appendChild(playerEl);
            });
            
            // Also update the settings player list
            updateSettingsPlayerList();
        }
        
        // Function to update the settings player list
        function updateSettingsPlayerList() {
            settingsPlayerListEl.innerHTML = `
                <div class="player-item" style="font-weight: bold;">
                    <span>Player Name</span>
                    <span>Action</span>
                </div>
            `;
            
            players.forEach((player, index) => {
                const playerEl = document.createElement('div');
                playerEl.className = 'player-item';
                playerEl.innerHTML = `
                    <span class="player-name">${player.name}</span>
                    <span class="remove-player" onclick="removePlayerFromSettings(${index})">
                        <i class="fas fa-times"></i> Remove
                    </span>
                `;
                settingsPlayerListEl.appendChild(playerEl);
            });
        }
        
        // Function to remove a player
        function removePlayer(index) {
            players.splice(index, 1);
            updatePlayerList();
        }
        
        // Function to remove a player from settings
        function removePlayerFromSettings(index) {
            players.splice(index, 1);
            updatePlayerList();
            updateScoreboard();
        }
        
        // Function to update the scoreboard
        function updateScoreboard() {
            scoreboardEl.innerHTML = '';
            
            // Sort players by score (descending)
            const sortedPlayers = [...players].sort((a, b) => b.score - a.score);
            
            sortedPlayers.forEach(player => {
                const scoreItem = document.createElement('div');
                scoreItem.className = 'scoreboard-item';
                scoreItem.innerHTML = `
                    <div class="scoreboard-player">${player.name}</div>
                    <div class="scoreboard-score">${player.score}</div>
                `;
                scoreboardEl.appendChild(scoreItem);
            });
        }
        
        // Function to submit the player name
        function submitName() {
            playerName = playerNameInput.value.trim();
            
            if (!playerName) {
                alert('Please enter your name');
                return;
            }
            
            // Add the describer as a player
            players.push({
                name: playerName,
                score: 0,
                isDescriber: true
            });
            
            // Clear the name input field
            playerNameInput.value = '';
            
            // Update player info
            playerInfoEl.textContent = playerName;
            
            // Hide the name screen and show the game screen
            nameScreen.style.display = 'none';
            gameScreen.style.display = 'block';
            
            // Update the scoreboard
            updateScoreboard();
            
            // Initialize the Word Guess Challenge game
            initWordGuessChallenge();
        }
        
        // Function to initialize the Word Guess Challenge game
        function initWordGuessChallenge() {
            // Load the default words
            wordData = defaultWords.map(word => {
                const parts = word.split(' - ');
                return {
                    word: parts[0],
                    definition: parts[1] || ""
                };
            });
            
            usedIndices = [];
            gameStarted = false;
            
            // Show the file load section
            fileLoadSection.style.display = 'block';
            
            // Hide the timer and input sections
            timerSection.classList.add('hidden');
            inputSection.classList.add('hidden');
            
            // Set the definition text
            definitionEl.textContent = "Click 'Start Game' to begin playing!";
            wordsContainerEl.innerHTML = '';
        }
        
        // Function to start the Word Guess Challenge game
        function startWordGuessChallenge() {
            if (!gameStarted) {
                gameStarted = true;
                
                // Hide the file load section
                fileLoadSection.style.display = 'none';
                
                // Show the timer and input sections
                timerSection.classList.remove('hidden');
                inputSection.classList.remove('hidden');
                
                // Load the first set of words
                loadNextWordSet();
            }
        }
        
        // Function to load the next set of words
        function loadNextWordSet() {
            // If we've used all words, reset the used indices and increment round
            if (usedIndices.length >= wordData.length) {
                usedIndices = [];
                currentRound++;
                roundCounterEl.textContent = `Round: ${currentRound}`;
                roundDisplayEl.textContent = `Round: ${currentRound}`;
            }
            
            // Get random words that haven't been used yet
            currentWords = [];
            const wordsToGet = Math.min(gameSettings.wordsCount, wordData.length - usedIndices.length);
            
            for (let i = 0; i < wordsToGet; i++) {
                let randomIndex;
                do {
                    randomIndex = Math.floor(Math.random() * wordData.length);
                } while (usedIndices.includes(randomIndex));
                
                usedIndices.push(randomIndex);
                currentWords.push(wordData[randomIndex]);
            }
            
            // Display the words
            displayWords(currentWords);
            
            // Hide the feedback and copy button
            feedbackWgcEl.style.display = 'none';
            feedbackWgcEl.className = 'wgc-feedback';
            document.getElementById('copy-btn').style.display = 'none';
            
            // Reset the timer
            timeLeftWGC = gameSettings.timerDuration;
            updateTimerDisplay();
            
            // Start the timer
            startTimer();
        }
        
        // Function to display words in the container
        function displayWords(words) {
            wordsContainerEl.innerHTML = '';
            
            words.forEach((wordData, index) => {
                const wordEl = document.createElement('div');
                wordEl.className = 'word-item';
                wordEl.setAttribute('data-index', index);
                
                // Create word text
                const wordText = document.createElement('div');
                wordText.className = 'word-text';
                wordText.textContent = wordData.word;
                
                // Create dropdown for players
                const dropdown = document.createElement('select');
                dropdown.className = 'word-dropdown';
                
                // Add default option
                const defaultOption = document.createElement('option');
                defaultOption.value = '';
                defaultOption.textContent = 'Select player';
                defaultOption.disabled = true;
                defaultOption.selected = true;
                dropdown.appendChild(defaultOption);
                
                // Add players to dropdown (excluding the describer)
                players.forEach(player => {
                    if (!player.isDescriber) {
                        const option = document.createElement('option');
                        option.value = player.name;
                        option.textContent = player.name;
                        dropdown.appendChild(option);
                    }
                });
                
                // Add event listener to dropdown
                dropdown.addEventListener('change', function() {
                    if (this.value) {
                        awardPoints(this.value, wordData, index);
                        this.disabled = true;
                    }
                });
                
                // Add elements to word item
                wordEl.appendChild(wordText);
                wordEl.appendChild(dropdown);
                
                wordsContainerEl.appendChild(wordEl);
            });
        }
        
        // Function to award points to a player
        function awardPoints(playerName, wordData, wordIndex) {
            if (!gameActiveWGC) return;
            
            // Find the player
            const player = players.find(p => p.name === playerName);
            if (!player) return;
            
            // Stop the timer if all words are completed
            const allWordsGuessed = Array.from(wordsContainerEl.children).every(wordEl => 
                wordEl.querySelector('select').disabled
            );
            
            if (allWordsGuessed) {
                clearInterval(timerWGC);
                gameActiveWGC = false;
            }
            
            // Fixed 7 points per word
            const points = 7;
            
            // Award points to the player
            player.score += points;
            
            // Mark the word as completed
            const wordEl = document.querySelector(`.word-item[data-index="${wordIndex}"]`);
            wordEl.classList.add('correct');
            
            // Update scoreboard
            updateScoreboard();
            
            // Show feedback
            showFeedback(`${player.name} guessed "${wordData.word}"! +${points} points`, 'success');
            
            // Check if all words have been guessed
            if (allWordsGuessed) {
                // Show the copy button
                document.getElementById('copy-btn').style.display = 'block';
            }
        }
        
        // Function to skip the current word set
        function skipWordSet() {
            if (!gameActiveWGC) return;
            
            // Stop the timer
            clearInterval(timerWGC);
            gameActiveWGC = false;
            
            // Mark all words as skipped
            Array.from(wordsContainerEl.children).forEach(wordEl => {
                if (!wordEl.classList.contains('correct')) {
                    wordEl.classList.add('skipped');
                    wordEl.querySelector('select').disabled = true;
                }
            });
            
            // Show feedback that the set was skipped
            showFeedback('Skipped the word set!', 'warning');
            
            // Show the copy button
            document.getElementById('copy-btn').style.display = 'block';
        }
        
        // Function to handle file selection
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                parseWordFile(content);
            };
            reader.readAsText(file);
        }
        
        // Function to parse the word file
        function parseWordFile(content) {
            const lines = content.split('\n');
            const newWordData = [];
            
            for (const line of lines) {
                const trimmedLine = line.trim();
                if (trimmedLine) {
                    const parts = trimmedLine.split(' - ');
                    if (parts.length >= 1) {
                        newWordData.push({
                            word: parts[0].trim(),
                            definition: parts[1] ? parts[1].trim() : ""
                        });
                    }
                }
            }
            
            if (newWordData.length > 0) {
                wordData = newWordData;
                showNotification(`Loaded ${wordData.length} words from file`);
                definitionEl.textContent = "Words loaded! Click 'Start Game' to begin playing!";
            } else {
                alert('No valid words found in the file');
            }
        }
        
        // Function to start the timer
        function startTimer() {
            // Clear any existing timer
            if (timerWGC) {
                clearInterval(timerWGC);
            }
            
            gameActiveWGC = true;
            
            // Reset timer to initial value
            timeLeftWGC = gameSettings.timerDuration;
            
            // Update timer display immediately
            updateTimerDisplay();
            
            // Set up the timer interval
            timerWGC = setInterval(() => {
                timeLeftWGC--;
                updateTimerDisplay();
                
                if (timeLeftWGC <= 0) {
                    // Clear the timer
                    clearInterval(timerWGC);
                    gameActiveWGC = false;
                    
                    // Mark all unguessed words as skipped
                    Array.from(wordsContainerEl.children).forEach(wordEl => {
                        if (!wordEl.classList.contains('correct')) {
                            wordEl.classList.add('skipped');
                            wordEl.querySelector('select').disabled = true;
                        }
                    });
                    
                    // Show feedback when timer expires
                    showFeedback('Time\'s up! Moving to next word set.', 'error');
                    document.getElementById('copy-btn').style.display = 'block';
                }
            }, 1000);
        }
        
        // Function to update the timer display
        function updateTimerDisplay() {
            // Update the timer text
            timeWgcEl.textContent = timeLeftWGC;
            
            // Calculate the percentage for the progress bar
            const maxTime = gameSettings.timerDuration;
            const percentage = (timeLeftWGC / maxTime) * 100;
            timerBarEl.style.width = percentage + '%';
            
            // Change color based on time left
            if (percentage > 50) {
                timerBarEl.style.background = 'linear-gradient(90deg, #667eea 0%, #764ba2 100%)';
            } else if (percentage > 20) {
                timerBarEl.style.background = 'linear-gradient(90deg, #fa709a 0%, #fee140 100%)';
            } else {
                timerBarEl.style.background = 'linear-gradient(90deg, #f093fb 0%, #f5576c 100%)';
            }
        }
        
        // Function to show feedback
        function showFeedback(message, type) {
            feedbackWgcEl.textContent = message;
            feedbackWgcEl.className = 'wgc-feedback ' + type;
            feedbackWgcEl.style.display = 'block';
        }
        
        // Function to show notification
        function showNotification(message) {
            notification.textContent = message;
            notification.classList.add('show');
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Function to copy results to clipboard
        function copyToFFT() {
            let resultText = `TaboGame Results - Round ${currentRound}\n\n`;
            
            // Sort players by score (descending)
            const sortedPlayers = [...players].sort((a, b) => b.score - a.score);
            
            sortedPlayers.forEach((player, index) => {
                resultText += `${index + 1}. ${player.name}: ${player.score} points\n`;
            });
            
            // Copy to clipboard
            navigator.clipboard.writeText(resultText).then(() => {
                showNotification('Results copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                showNotification('Failed to copy results to clipboard.');
            });
        }
        
        // Function to open settings
        function openSettings() {
            // Set current values in settings modal
            timerDurationSlider.value = gameSettings.timerDuration;
            timerDurationValue.textContent = gameSettings.timerDuration + ' seconds';
            
            wordsCountSlider.value = gameSettings.wordsCount;
            wordsCountValue.textContent = gameSettings.wordsCount + (gameSettings.wordsCount == 1 ? ' word' : ' words');
            
            // Update player list in settings
            updateSettingsPlayerList();
            
            settingsModal.style.display = 'flex';
        }
        
        // Function to close settings
        function closeSettings() {
            settingsModal.style.display = 'none';
        }
        
        // Function to save settings
        function saveSettings() {
            gameSettings.timerDuration = parseInt(timerDurationSlider.value);
            gameSettings.wordsCount = parseInt(wordsCountSlider.value);
            
            // Update the words count label if game is active
            if (gameStarted) {
                // No label in this version
            }
            
            closeSettings();
            showNotification('Settings saved successfully!');
        }
        
        // Function to reset the game
        function resetGame() {
            // Stop any active timers
            if (timerWGC) {
                clearInterval(timerWGC);
            }
            
            // Reset game state
            gameActiveWGC = false;
            currentRound = 1;
            roundCounterEl.textContent = `Round: ${currentRound}`;
            roundDisplayEl.textContent = `Round: ${currentRound}`;
            
            // Reset player scores
            players.forEach(player => {
                player.score = 0;
            });
            
            // Update scoreboard
            updateScoreboard();
            
            // Reinitialize the game
            initWordGuessChallenge();
        }
        
        // Function to go to next round
        function nextRound() {
            currentRound++;
            roundCounterEl.textContent = `Round: ${currentRound}`;
            roundDisplayEl.textContent = `Round: ${currentRound}`;
            loadNextWordSet();
        }
    </script>
</body>
</html>
